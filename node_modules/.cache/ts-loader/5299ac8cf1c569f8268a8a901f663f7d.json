{"remainingRequest":"/home/george/projects/gem-farm-chimps-v2/node_modules/babel-loader/lib/index.js!/home/george/projects/gem-farm-chimps-v2/node_modules/ts-loader/index.js??ref--14-2!/home/george/projects/gem-farm-chimps-v2/src/common/web3/NFTget.ts","dependencies":[{"path":"/home/george/projects/gem-farm-chimps-v2/src/common/web3/NFTget.ts","mtime":1651784671825},{"path":"/home/george/projects/gem-farm-chimps-v2/babel.config.js","mtime":1651784671821},{"path":"/home/george/projects/gem-farm-chimps-v2/node_modules/cache-loader/dist/cjs.js","mtime":1648666880328},{"path":"/home/george/projects/gem-farm-chimps-v2/node_modules/babel-loader/lib/index.js","mtime":1648666880284},{"path":"/home/george/projects/gem-farm-chimps-v2/node_modules/ts-loader/index.js","mtime":1648666885109}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL2dlb3JnZS9wcm9qZWN0cy9nZW0tZmFybS1jaGltcHMtdjIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5jb25jYXQuanMiOwppbXBvcnQgeyBQdWJsaWNLZXkgfSBmcm9tICdAc29sYW5hL3dlYjMuanMnOwppbXBvcnQgeyBUT0tFTl9QUk9HUkFNX0lEIH0gZnJvbSAnQHNvbGFuYS9zcGwtdG9rZW4nOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgeyBwcm9ncmFtcyB9IGZyb20gJ0BtZXRhcGxleC9qcyc7Cgp2YXIgZnMgPSByZXF1aXJlKCdmcycpOwoKdmFyIE1ldGFkYXRhID0gcHJvZ3JhbXMubWV0YWRhdGEuTWV0YWRhdGE7CgpmdW5jdGlvbiBnZXRUb2tlbnNCeU93bmVyKF94LCBfeDIpIHsKICByZXR1cm4gX2dldFRva2Vuc0J5T3duZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX2dldFRva2Vuc0J5T3duZXIoKSB7CiAgX2dldFRva2Vuc0J5T3duZXIgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUob3duZXIsIGNvbm4pIHsKICAgIHZhciB0b2tlbnMsIHRlOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGNvbm4uZ2V0UGFyc2VkVG9rZW5BY2NvdW50c0J5T3duZXIob3duZXIsIHsKICAgICAgICAgICAgICBwcm9ncmFtSWQ6IFRPS0VOX1BST0dSQU1fSUQKICAgICAgICAgICAgfSk7CgogICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICB0b2tlbnMgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICB0ZSA9IHRva2Vucy52YWx1ZTsgLy8gaW5pdGlhbCBmaWx0ZXIgLSBvbmx5IHRva2VucyB3aXRoIDAgZGVjaW1hbHMgJiBvZiB3aGljaCAxIGlzIHByZXNlbnQgaW4gdGhlIHdhbGxldAoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgdG9rZW5zLnZhbHVlLmZpbHRlcihmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHZhciBhbW91bnQgPSB0LmFjY291bnQuZGF0YS5wYXJzZWQuaW5mby50b2tlbkFtb3VudDsKICAgICAgICAgICAgICByZXR1cm4gYW1vdW50LmRlY2ltYWxzID09PSAwICYmIGFtb3VudC51aUFtb3VudCA9PT0gMTsKICAgICAgICAgICAgfSkubWFwKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIHB1YmtleTogdC5wdWJrZXksCiAgICAgICAgICAgICAgICBtaW50OiB0LmFjY291bnQuZGF0YS5wYXJzZWQuaW5mby5taW50CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSkpOwoKICAgICAgICAgIGNhc2UgNToKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlKTsKICB9KSk7CiAgcmV0dXJuIF9nZXRUb2tlbnNCeU93bmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIGdldE5GVE1ldGFkYXRhKF94MywgX3g0LCBfeDUpIHsKICByZXR1cm4gX2dldE5GVE1ldGFkYXRhLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7Cn0KCmZ1bmN0aW9uIF9nZXRORlRNZXRhZGF0YSgpIHsKICBfZ2V0TkZUTWV0YWRhdGEgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKG1pbnQsIGNvbm4sIHB1YmtleSkgewogICAgdmFyIGF0dGVtcHQsCiAgICAgICAgX29uY2hhaW5NZXRhZGF0YSwKICAgICAgICBfZXh0ZXJuYWxNZXRhZGF0YSwKICAgICAgICBmaWxlcGF0aCwKICAgICAgICByZXNwb25zZSwKICAgICAgICBuZnRkYXRhLAogICAgICAgIG1ldGFkYXRhUERBLAogICAgICAgIG9uY2hhaW5NZXRhZGF0YSwKICAgICAgICBleHRlcm5hbE1ldGFkYXRhLAogICAgICAgIF9hcmdzMiA9IGFyZ3VtZW50czsKCiAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBhdHRlbXB0ID0gX2FyZ3MyLmxlbmd0aCA+IDMgJiYgX2FyZ3MyWzNdICE9PSB1bmRlZmluZWQgPyBfYXJnczJbM10gOiAtMTsKICAgICAgICAgICAgX2NvbnRleHQyLnByZXYgPSAxOwogICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDI7CiAgICAgICAgICAgIF9vbmNoYWluTWV0YWRhdGEgPSB7fTsKICAgICAgICAgICAgX2V4dGVybmFsTWV0YWRhdGEgPSB7fTsKICAgICAgICAgICAgZmlsZXBhdGggPSAiL2NhY2hlLyIgKyBtaW50ICsgIi9hLmpzb24iOwogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDg7CiAgICAgICAgICAgIHJldHVybiBmZXRjaChmaWxlcGF0aCk7CgogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICByZXNwb25zZSA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDExOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwoKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgIG5mdGRhdGEgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgX29uY2hhaW5NZXRhZGF0YS5kYXRhID0gewogICAgICAgICAgICAgIHN5bWJvbDogbmZ0ZGF0YS5tZXRhZGF0YS5zeW1ib2wsCiAgICAgICAgICAgICAgbmFtZTogbmZ0ZGF0YS5tZXRhZGF0YS5uYW1lLAogICAgICAgICAgICAgIGNyZWF0b3JzOiBuZnRkYXRhLnRva2VuRGF0YS5jcmVhdG9ycwogICAgICAgICAgICB9OwogICAgICAgICAgICBfZXh0ZXJuYWxNZXRhZGF0YS5pbWFnZSA9ICIvY2FjaGUvIiArIG1pbnQgKyAiL2MucG5nIjsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIHsKICAgICAgICAgICAgICBwdWJrZXk6IHB1YmtleSA/IG5ldyBQdWJsaWNLZXkocHVia2V5KSA6IHVuZGVmaW5lZCwKICAgICAgICAgICAgICBtaW50OiBuZXcgUHVibGljS2V5KG1pbnQpLAogICAgICAgICAgICAgIG9uY2hhaW5NZXRhZGF0YTogX29uY2hhaW5NZXRhZGF0YSwKICAgICAgICAgICAgICBleHRlcm5hbE1ldGFkYXRhOiBfZXh0ZXJuYWxNZXRhZGF0YQogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDE3OwogICAgICAgICAgICBfY29udGV4dDIudDAgPSBfY29udGV4dDJbImNhdGNoIl0oMik7CiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoX2NvbnRleHQyLnQwKTsKICAgICAgICAgICAgY29uc29sZS5sb2coImZhaWxlZCB0byBwdWxsIG1ldGFkYXRhIGZvciB0b2tlbiAiLmNvbmNhdChtaW50KSk7CgogICAgICAgICAgY2FzZSAyMToKICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAyMzsKICAgICAgICAgICAgcmV0dXJuIE1ldGFkYXRhLmdldFBEQShtaW50KTsKCiAgICAgICAgICBjYXNlIDIzOgogICAgICAgICAgICBtZXRhZGF0YVBEQSA9IF9jb250ZXh0Mi5zZW50OwogICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI2OwogICAgICAgICAgICByZXR1cm4gTWV0YWRhdGEubG9hZChjb25uLCBtZXRhZGF0YVBEQSk7CgogICAgICAgICAgY2FzZSAyNjoKICAgICAgICAgICAgb25jaGFpbk1ldGFkYXRhID0gX2NvbnRleHQyLnNlbnQuZGF0YTsKCiAgICAgICAgICAgIGlmICghKG9uY2hhaW5NZXRhZGF0YS5kYXRhLnN5bWJvbC50b0xvd2VyQ2FzZSgpID09ICJsdXhyIiB8fCBvbmNoYWluTWV0YWRhdGEuZGF0YS5zeW1ib2wudG9Mb3dlckNhc2UoKSA9PSAibHV4ZSIpKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzMTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAzMDsKICAgICAgICAgICAgcmV0dXJuIGF4aW9zLmdldChvbmNoYWluTWV0YWRhdGEuZGF0YS51cmkpOwoKICAgICAgICAgIGNhc2UgMzA6CiAgICAgICAgICAgIGV4dGVybmFsTWV0YWRhdGEgPSBfY29udGV4dDIuc2VudC5kYXRhOwoKICAgICAgICAgIGNhc2UgMzE6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCB7CiAgICAgICAgICAgICAgcHVia2V5OiBwdWJrZXkgPyBuZXcgUHVibGljS2V5KHB1YmtleSkgOiB1bmRlZmluZWQsCiAgICAgICAgICAgICAgbWludDogbmV3IFB1YmxpY0tleShtaW50KSwKICAgICAgICAgICAgICBvbmNoYWluTWV0YWRhdGE6IG9uY2hhaW5NZXRhZGF0YSwKICAgICAgICAgICAgICBleHRlcm5hbE1ldGFkYXRhOiBleHRlcm5hbE1ldGFkYXRhCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIGNhc2UgMzQ6CiAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMzQ7CiAgICAgICAgICAgIF9jb250ZXh0Mi50MSA9IF9jb250ZXh0MlsiY2F0Y2giXSgxKTsKICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhfY29udGV4dDIudDEpOwogICAgICAgICAgICBjb25zb2xlLmxvZygiZmFpbGVkIHRvIHB1bGwgbWV0YWRhdGEgZm9yIHRva2VuICIuY29uY2F0KG1pbnQpKTsKCiAgICAgICAgICBjYXNlIDM4OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMiwgbnVsbCwgW1sxLCAzNF0sIFsyLCAxN11dKTsKICB9KSk7CiAgcmV0dXJuIF9nZXRORlRNZXRhZGF0YS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpleHBvcnQgZnVuY3Rpb24gZ2V0TkZUTWV0YWRhdGFGb3JNYW55KF94NiwgX3g3KSB7CiAgcmV0dXJuIF9nZXRORlRNZXRhZGF0YUZvck1hbnkuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gX2dldE5GVE1ldGFkYXRhRm9yTWFueSgpIHsKICBfZ2V0TkZUTWV0YWRhdGFGb3JNYW55ID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyh0b2tlbnMsIGNvbm4pIHsKICAgIHZhciBwcm9taXNlcywgbmZ0c190ZW1wLCB0b2ssIG5mdCwgX25mdHNfdGVtcCRuZnQkb25jaGFpLCBfbmZ0c190ZW1wJG5mdCRvbmNoYWkyLCBfbmZ0c190ZW1wJG5mdCRvbmNoYWkzLCBfbmZ0c190ZW1wJG5mdCRvbmNoYWk0LCBhZGRyZXNzLCBuZnRzOwoKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHByb21pc2VzID0gW107CiAgICAgICAgICAgIHRva2Vucy5mb3JFYWNoKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2VzLnB1c2goZ2V0TkZUTWV0YWRhdGEodC5taW50LCBjb25uLCB0LnB1YmtleSkpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgbmZ0c190ZW1wID0ge307CiAgICAgICAgICAgIF9jb250ZXh0My5uZXh0ID0gNTsKICAgICAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKTsKCiAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgIG5mdHNfdGVtcCA9IF9jb250ZXh0My5zZW50LmZpbHRlcihmdW5jdGlvbiAobikgewogICAgICAgICAgICAgIHJldHVybiAhIW47CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0b2sgPSBbXTsKCiAgICAgICAgICAgIGZvciAobmZ0IGluIG5mdHNfdGVtcCkgewogICAgICAgICAgICAgIGlmICgoKF9uZnRzX3RlbXAkbmZ0JG9uY2hhaSA9IG5mdHNfdGVtcFtuZnRdLm9uY2hhaW5NZXRhZGF0YSkgPT09IG51bGwgfHwgX25mdHNfdGVtcCRuZnQkb25jaGFpID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX25mdHNfdGVtcCRuZnQkb25jaGFpMiA9IF9uZnRzX3RlbXAkbmZ0JG9uY2hhaS5kYXRhKSA9PT0gbnVsbCB8fCBfbmZ0c190ZW1wJG5mdCRvbmNoYWkyID09PSB2b2lkIDAgPyB2b2lkIDAgOiAoX25mdHNfdGVtcCRuZnQkb25jaGFpMyA9IF9uZnRzX3RlbXAkbmZ0JG9uY2hhaTIuY3JlYXRvcnMpID09PSBudWxsIHx8IF9uZnRzX3RlbXAkbmZ0JG9uY2hhaTMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9uZnRzX3RlbXAkbmZ0JG9uY2hhaTMubGVuZ3RoKSA+IDApIHsKICAgICAgICAgICAgICAgIGFkZHJlc3MgPSAoKF9uZnRzX3RlbXAkbmZ0JG9uY2hhaTQgPSBuZnRzX3RlbXBbbmZ0XS5vbmNoYWluTWV0YWRhdGEuZGF0YS5jcmVhdG9yc1swXSkgPT09IG51bGwgfHwgX25mdHNfdGVtcCRuZnQkb25jaGFpNCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX25mdHNfdGVtcCRuZnQkb25jaGFpNC5hZGRyZXNzKSB8fCAiICI7CiAgICAgICAgICAgICAgICBpZiAoYWRkcmVzcyA9PSAnN0hkdFVld21qcEZuRThTS2haRFlHQ0ttTDc1WldVeEpwNnhhMUhybUp3dzgnIHx8IGFkZHJlc3MgPT0gJ0FHREJlVWFLUmVxRTNEZHRXcTZKOVRSQWFyU2NCUmhHSjc3Y0Q4MndMTnZEJyB8fCBhZGRyZXNzID09ICc1Z3gxM21BZGU4a2p4MmFldmhjZUJKdGlQRE5vNzhXcHBGemQ5UmRWTjVjaCcpIHRvay5wdXNoKG5mdHNfdGVtcFtuZnRdKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5mdHMgPSB0b2s7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJmb3VuZCBtZXRhZGF0YSBtYXRjaGluZyIuY29uY2F0KG5mdHMubGVuZ3RoLCAiIHRva2VucyA6IGZpbHRlcmVkICIpLmNvbmNhdChuZnRzX3RlbXAubGVuZ3RoIC0gbmZ0cy5sZW5ndGgpKTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIG5mdHMpOwoKICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUzKTsKICB9KSk7CiAgcmV0dXJuIF9nZXRORlRNZXRhZGF0YUZvck1hbnkuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGdldE5GVHNCeU93bmVyKF94OCwgX3g5KSB7CiAgcmV0dXJuIF9nZXRORlRzQnlPd25lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwp9CgpmdW5jdGlvbiBfZ2V0TkZUc0J5T3duZXIoKSB7CiAgX2dldE5GVHNCeU93bmVyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNChvd25lciwgY29ubikgewogICAgdmFyIHRva2VuczsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjsKICAgICAgICAgICAgcmV0dXJuIGdldFRva2Vuc0J5T3duZXIob3duZXIsIGNvbm4pOwoKICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgdG9rZW5zID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoImZvdW5kICIuY29uY2F0KHRva2Vucy5sZW5ndGgsICIgdG9rZW5zIikpOwogICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDY7CiAgICAgICAgICAgIHJldHVybiBnZXRORlRNZXRhZGF0YUZvck1hbnkodG9rZW5zLCBjb25uKTsKCiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCBfY29udGV4dDQuc2VudCk7CgogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlNCk7CiAgfSkpOwogIHJldHVybiBfZ2V0TkZUc0J5T3duZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQ=="},{"version":3,"sources":["/home/george/projects/gem-farm-chimps-v2/src/common/web3/NFTget.ts"],"names":[],"mappings":"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","sourcesContent":["import { Connection, PublicKey } from '@solana/web3.js';\nimport { TOKEN_PROGRAM_ID } from '@solana/spl-token';\nimport axios from 'axios';\nimport { programs } from '@metaplex/js';\nconst fs = require('fs');\n\nconst {\n  metadata: { Metadata },\n} = programs;\n\nexport interface INFT {\n  pubkey?: PublicKey;\n  mint: PublicKey;\n  onchainMetadata: unknown;\n  externalMetadata: unknown;\n}\n\nasync function getTokensByOwner(owner: PublicKey, conn: Connection) {\n  const tokens = await conn.getParsedTokenAccountsByOwner(owner, {\n    programId: TOKEN_PROGRAM_ID,\n  });\n  let te = tokens.value;\n  // initial filter - only tokens with 0 decimals & of which 1 is present in the wallet\n  return tokens.value\n    .filter((t) => {\n      const amount = t.account.data.parsed.info.tokenAmount;\n      return amount.decimals === 0 && amount.uiAmount === 1;\n    })\n    .map((t) => {\n      return { pubkey: t.pubkey, mint: t.account.data.parsed.info.mint };\n    });\n}\n\nasync function getNFTMetadata(\n  mint: string,\n  conn: Connection,\n  pubkey?: string,\n  attempt: number = -1\n): Promise<INFT | undefined> {\n  // console.log('Pulling metadata for:', mint);\n  try {\n    try{\n    let onchainMetadata :any = {};\n    let externalMetadata  :any = {};\n    let filepath = \"/cache/\" + mint + \"/a.json\";\n    let response = await fetch(filepath); \n    let nftdata = await response.json(); \n    \n    onchainMetadata.data = {symbol: nftdata.metadata.symbol, name: nftdata.metadata.name, creators: nftdata.tokenData.creators}\n    externalMetadata.image = \"/cache/\" + mint + \"/c.png\";\n    \n    return {\n      pubkey: pubkey ? new PublicKey(pubkey) : undefined,\n      mint: new PublicKey(mint),\n      onchainMetadata,\n      externalMetadata,\n    };\n  } catch (e) {   \n      console.debug(e);\n      console.log(`failed to pull metadata for token ${mint}`);    \n  }\n    const metadataPDA = await Metadata.getPDA(mint);\n    const onchainMetadata = (await Metadata.load(conn, metadataPDA)).data;\n    let externalMetadata  :any;\n   \n    if(onchainMetadata.data.symbol.toLowerCase() == \"luxr\" || onchainMetadata.data.symbol.toLowerCase() == \"luxe\")\n    {\n      externalMetadata = (await axios.get(onchainMetadata.data.uri)).data;\n    }\n\n  return {\n    pubkey: pubkey ? new PublicKey(pubkey) : undefined,\n    mint: new PublicKey(mint),\n    onchainMetadata,\n    externalMetadata,\n  };\n} catch (e) {   \n  console.debug(e);\n  console.log(`failed to pull metadata for token ${mint}`);    \n}\n}\n\nexport async function getNFTMetadataForMany(\n  tokens: any[],\n  conn: Connection\n): Promise<INFT[]> {\n  const promises: Promise<INFT | undefined>[] = [];  \n  tokens.forEach((t) => promises.push(getNFTMetadata(t.mint, conn, t.pubkey)));\n\n  let nfts_temp : { [key: string]: any } = {};\n  nfts_temp = (await Promise.all(promises)).filter((n) => !!n);\n \n  let tok=[];\n  for( let nft in nfts_temp)\n  {\n    if(nfts_temp[nft].onchainMetadata?.data?.creators?.length > 0)\n    {\n      let address =  nfts_temp[nft].onchainMetadata.data.creators[0]?.address || \" \";\n      if(address == '7HdtUewmjpFnE8SKhZDYGCKmL75ZWUxJp6xa1HrmJww8'|| address == 'AGDBeUaKReqE3DdtWq6J9TRAarScBRhGJ77cD82wLNvD' || address == '5gx13mAde8kjx2aevhceBJtiPDNo78WppFzd9RdVN5ch' )\n        tok.push(nfts_temp[nft]);\n    }\n  }\n  const nfts = tok\n  \n  console.log(`found metadata matching${nfts.length} tokens : filtered ${nfts_temp.length - nfts.length}`);\n\n  return nfts as INFT[];\n}\n\nexport async function getNFTsByOwner(\n  owner: PublicKey,\n  conn: Connection\n): Promise<INFT[]> {\n  const tokens = await getTokensByOwner(owner, conn);\n  console.debug(`found ${tokens.length} tokens`);\n\n  return await getNFTMetadataForMany(tokens, conn);\n}\n"],"sourceRoot":""}]}